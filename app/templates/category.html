
  <style>
    body {
      font-family: "Montserrat", sans-serif;
    }
    .filters-wrapper {
      display: flex;
      flex-wrap: wrap;
      gap: 1rem;
      margin-bottom: 2rem;
      justify-content: center;
    }
    .filter-dropdown {
      position: relative;
      min-width: 180px;
    }
    .filter-toggle {
      background-color: #fff;
      color: #2c3e50;
      border: 1px solid #2c3e50;
      padding: 0.5rem 1.5rem 0.5rem 1rem;
      border-radius: 1rem;
      cursor: pointer;
      font-size: 16px;
      transition: background 0.3s;
      position: relative;
      text-align: left;
      width: 100%;
    }
    .filter-toggle::after {
      content: '‚ñº';
      position: absolute;
      right: 1rem;
      top: 50%;
      transform: translateY(-50%);
      font-size: 12px;
      pointer-events: none;
      color: #2c3e50;
    }
    .filter-toggle:hover {
      background-color: #f5f5f5;
    }
    .filter-options {
      display: none;
      position: absolute;
      top: 100%;
      left: 0;
      z-index: 10;
      background: #fff;
      border: 1px solid #ccc;
      border-radius: 0.5rem;
      padding: 1rem;
      max-height: 200px;
      overflow-y: auto;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);
      white-space: nowrap;
    }
    .filter-options label {
  display: flex;              /* –¥–æ–∑–≤–æ–ª—è—î –∫–æ–Ω—Ç—Ä–æ–ª—é–≤–∞—Ç–∏ —Ä–æ–∑—Ç–∞—à—É–≤–∞–Ω–Ω—è –≤–º—ñ—Å—Ç—É */
  align-items: center;        /* –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–µ –≤–∏—Ä—ñ–≤–Ω—é–≤–∞–Ω–Ω—è */
  justify-content: flex-start; /* –≤–∏—Ä—ñ–≤–Ω—é–≤–∞–Ω–Ω—è –≤–ª—ñ–≤–æ */
  margin-bottom: 0.5rem;
  text-align: left;
  gap: 0.5rem;
}

    .filter-dropdown.open .filter-options {
      display: block;
    }
    .reset-single-filter {
      display: block;
      margin-top: 0.5rem;
      font-size: 0.85rem;
      color: #3498db;
      text-decoration: underline;
      cursor: pointer;
      background: none;
      border: none;
      padding: 0;
    }
    .filter-tabs-wrapper {
  display: flex;
  align-items: center;
  justify-content: flex-start;
  position: relative;
  margin: 1rem auto 2rem;
  /* padding: 0 1rem; */
  max-width: 100%;
  overflow: hidden;
  border-bottom: 1px solid #2c3e50;
}

.filter-tabs {
  display: flex;
  flex-wrap: nowrap;
  gap: 2rem;
  overflow-x: auto;
  scrollbar-width: none; /* Firefox */
  -ms-overflow-style: none;  /* IE 10+ */
}

.filter-tabs::-webkit-scrollbar {
  display: none; /* Chrome/Safari/Webkit */
}

.tab-btn {
  background: none;
  border: none;
  font-size: 18px;
  font-family: "Montserrat", sans-serif;
  cursor: pointer;
  padding: 0.3rem 0;
  color: #2c3e50;
  border-bottom: 3px solid transparent;
  transition: border-color 0.3s, color 0.3s;
  white-space: nowrap;
}

.tab-btn:hover {
  color: #000;
}

.tab-btn.active {
  border-bottom: 3px solid #2c3e50;
  font-weight: 600;
}




.scroll-arrow {
  background: #f9f9f9;
  border: 1px solid #2c3e50;
  border-radius: 50%;
  padding: 0.2rem 0.6rem;
  font-size: 18px;
  cursor: pointer;
  margin-left: 0.5rem;
  transition: background 0.3s;
}

.scroll-arrow:hover {
  background: #eee;
}

.filter-tabs-wrapper {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 1rem;
  margin-bottom: 2rem;
}

.filter-tabs-container {
  overflow: hidden;
  width: 100%;
  max-width: 900px; /* —à–∏—Ä–∏–Ω–∞ –¥–ª—è 5 –∫–Ω–æ–ø–æ–∫ */
}

.filter-tabs-slider {
  display: flex;
  transition: transform 0.3s ease;
}

.tab-btn {
  flex: 0 0 160px; /* —à–∏—Ä–∏–Ω–∞ –æ–¥–Ω—ñ—î—ó –∫–Ω–æ–ø–∫–∏ */
  padding: 0.5rem 1rem;
  background: none;
  border: none;
  font-size: 16px;
  cursor: pointer;
  white-space: nowrap;
  color: #2c3e50;
  border-bottom: 2px solid transparent;
}

.tab-btn.active {
  font-weight: bold;
  border-color: #2c3e50;
}

.arrow {
  background: white;
  border: 1px solid #2c3e50;
  border-radius: 50%;
  width: 32px;
  height: 32px;
  font-size: 16px;
  cursor: pointer;
  line-height: 28px;
}

.filter-tabs-slider {
  display: flex;
  gap: 2rem;
  transition: transform 0.4s ease;
}
#header {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  z-index: 1000;
  
  box-shadow: 0 2px 5px rgba(0,0,0,0.1);
}
#main {
  padding-top: 100px; /* —â–æ–± –Ω–µ –ø–µ—Ä–µ–∫—Ä–∏–≤–∞–ª–æ –∫–æ–Ω—Ç–µ–Ω—Ç */
}

/* .bouquet-slider {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
  gap: 2.5rem;
  justify-content: center;
  max-width: 1200px;
  margin: 0 auto;
  padding: 1rem;
} */
.bouquet-slider {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: 2.5rem;
    justify-content: center;
    max-width: 1200px;
    margin: 0 auto;
    padding: 1rem;
}
.bouquet-slider .bouquet-clean-card {
    background: #fff;
    border-radius: 20px;
    padding: 1.2rem;
    transition: all 0.3s ease;
    box-shadow: 0 10px 24px rgba(0, 0, 0, 0.05);
    text-align: center;
}
@media (max-width: 600px) {
    .bouquet-slider {
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 1.5rem;
        padding: 0.5rem;
    }
}
.bouquet-clean-card {
  background: #fff;
  border-radius: 20px;
  padding: 1.2rem;
  transition: all 0.3s ease;
  box-shadow: 0 10px 24px rgba(0, 0, 0, 0.05);
  text-align: center;
}

.bouquet-clean-card:hover {
  transform: translateY(-6px);
  box-shadow: 0 14px 32px rgba(0, 0, 0, 0.1);
}

.bouquet-img-wrapper {
  position: relative;
  width: 100%;
  height: 360px;
  overflow: hidden;
  border-radius: 16px;
}

.bouquet-img-wrapper img {
  width: 100%;
  height: 100%;
  object-fit: cover;
  display: block;
  border-radius: 16px;
}

.fav-btn {
  position: absolute;
  top: 8px;
  right: 8px;
  background: white;
  border: none;
  border-radius: 50%;
  padding: 6px 8px;
  cursor: pointer;
  font-size: 16px;
  box-shadow: 0 2px 5px rgba(0,0,0,0.1);
  transition: background 0.2s ease;
}

.fav-btn:hover {
  background: #f5f5f5;
}

.bouquet-clean-card h3 {
  font-size: 18px;
  font-weight: 500;
  margin-top: 14px;
  color: #1a1a1a;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.bouquet-clean-card h3 a {
  text-decoration: none;
  color: inherit;
}

.bouquet-clean-card h3 a:hover {
  text-decoration: underline;
}

.bouquet-clean-card p {
  font-size: 18px;
  font-weight: 600;
  color: #2e624d;
  margin-top: 4px;
}


/* fadeIn –∑–Ω–∏–∑—É */
@keyframes fadeInUp {
  from {
    opacity: 0;
    transform: translateY(40px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* fadeIn —Å–ø—Ä–∞–≤–∞ */
@keyframes fadeInRight {
  from {
    opacity: 0;
    transform: translateX(40px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}

.reveal {
  opacity: 0;
  transform: translateY(40px);
  transition: opacity 0.6s ease, transform 0.6s ease;
  will-change: opacity, transform;
}

.reveal.visible {
  opacity: 1;
  transform: none;
}

.decor-layer {
  position: absolute;
  top: 300;
  left: 0;
  width: 100%;
  z-index: -10;
}

#dynamic-decor-container {
  position: relative;
  width: 100%;
  height: 100%;
  pointer-events: none;
}
.decor {
  position: absolute;
  pointer-events: none;
  z-index: -10;
}

@keyframes fadeInUp {
  from {
    opacity: 0;
    transform: translateY(30px) scale(0.95);
  }
  to {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
}

@keyframes fadeInLeft {
  from {
    opacity: 0;
    transform: translateX(-30px) rotate(-2deg) scale(0.95);
  }
  to {
    opacity: 1;
    transform: translateX(0) rotate(0) scale(1);
  }
}

@keyframes fadeInRight {
  from {
    opacity: 0;
    transform: translateX(30px) rotate(2deg) scale(0.95);
  }
  to {
    opacity: 1;
    transform: translateX(0) rotate(0) scale(1);
  }
}

.decor-animated {
  opacity: 0;
  animation-duration: 0.9s;
  animation-timing-function: ease-out;
  animation-fill-mode: forwards;
}
.load-more, .btn-to-cart, .filter-toggle {
  transition: transform 0.3s ease, box-shadow 0.3s ease;
}
.load-more:hover, .btn-to-cart:hover, .filter-toggle:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 20px rgba(0,0,0,0.1);
}


.decor {
  animation: fadeInDecor 0.8s ease-out;
  opacity: 0;
  animation-fill-mode: forwards;
}
body {
  opacity: 0;
  animation: fadeIn 1.2s ease forwards;
}

@keyframes fadeIn {
  to {
    opacity: 1;
  }
}

footer {
  min-height: 300px; /* –∞–±–æ —Å—Ç—ñ–ª—å–∫–∏, —Å–∫—ñ–ª—å–∫–∏ –∑–∞–π–º–∞—î —Ñ—É—Ç–µ—Ä */
  position: relative;
  z-index: 10;
}



.load-more {
  background: none;
  border: none;
  cursor: pointer;
  font-size: 1.2rem;
  font-weight: 600;
  font-family: "Montserrat", sans-serif;
  color: #103f3a; /* —Ç–µ–º–Ω–æ-–∑–µ–ª–µ–Ω–∏–π –∞–±–æ —è–∫ –Ω–∞ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—ñ */
  display: inline-flex;
  align-items: center;
  gap: 0.8rem;
  transition: all 0.3s ease;
}

.load-more:hover .load-more-text {
  text-decoration: underline;
}

.load-more-icon {
  width: 32px;
  height: 32px;
  border: 2px solid #000;
  border-radius: 50%;
  background-color: #e0e0e0; /* —Å–≤—ñ—Ç–ª–æ-—Å—ñ—Ä–∏–π —è–∫ –Ω–∞ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—ñ */
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 1.1rem;
  transition: background-color 0.3s ease, transform 0.2s ease;
}

.load-more:hover .load-more-icon {
  background-color: #ccc;
  transform: translateY(2px);
}
.pagination .btn {
  width: 36px;
  height: 36px;
  border-radius: 50%;
  border: 1.5px solid #2c3e50;
  background-color: white;
  color: #2c3e50;
  font-size: 16px;
  /* font-weight: 600; */
  display: inline-flex;
  align-items: center;
  justify-content: center;
  text-decoration: none;
  transition: all 0.2s ease;
  padding: 0;
  box-sizing: border-box;
  line-height: 1;
  overflow: hidden;
}

.pagination .btn:hover {
  background-color: #2c3e50;
  color: white;
}
.btn-to-cart {
  margin-top: 10px;
  background-color: #2e624d;
  color: white;
  border: none;
  padding: 0.6rem 1.2rem;
  font-size: 14px;
  font-weight: 600;
  border-radius: 10px;
  cursor: pointer;
  transition: background 0.3s ease;
  font-family: "Montserrat", sans-serif;
}

.btn-to-cart:hover {
  background-color: #244f3f;
}
.page-wrapper {
  min-height: 100vh;
  display: flex;
  flex-direction: column;
}
.posts-holder.bouquet-slider {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
  gap: 2.5rem;
  justify-content: center;
  max-width: 1200px;
  margin: 0 auto;
  padding: 1rem;
}

.bouquet-clean-card {
  background: #fff;
  border-radius: 20px;
  padding: 1.2rem;
  transition: all 0.3s ease;
  box-shadow: 0 10px 24px rgba(0, 0, 0, 0.05);
  text-align: center;
}

.bouquet-clean-card:hover {
  transform: translateY(-6px);
  box-shadow: 0 14px 32px rgba(0, 0, 0, 0.1);
}

.bouquet-img-wrapper {
  position: relative;
  width: 100%;
  height: 360px;
  overflow: hidden;
  border-radius: 16px;
}

.bouquet-img-wrapper img {
  width: 100%;
  height: 100%;
  object-fit: cover;
  display: block;
  border-radius: 16px;
}

.fav-btn {
  position: absolute;
  top: 8px;
  right: 8px;
  background: white;
  border: none;
  border-radius: 50%;
  padding: 6px 8px;
  cursor: pointer;
  font-size: 16px;
  box-shadow: 0 2px 5px rgba(0,0,0,0.1);
  transition: background 0.2s ease;
}

.fav-btn:hover {
  background: #f5f5f5;
}

.bouquet-clean-card h3 {
  font-size: 18px;
  font-weight: 500;
  margin-top: 14px;
  color: #1a1a1a;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.bouquet-clean-card h3 a {
  text-decoration: none;
  color: inherit;
}

.bouquet-clean-card h3 a:hover {
  text-decoration: underline;
}

.bouquet-clean-card p {
  font-size: 18px;
  font-weight: 600;
  color: #2e624d;
  margin-top: 4px;
}

.btn-to-cart {
  margin-top: 10px;
  background-color: #2e624d;
  color: white;
  border: none;
  padding: 0.6rem 1.2rem;
  font-size: 14px;
  font-weight: 600;
  border-radius: 10px;
  cursor: pointer;
  transition: background 0.3s ease;
  font-family: "Montserrat", sans-serif;
}

.btn-to-cart:hover {
  background-color: #244f3f;
}


  </style>
  
{% extends "base.html" %}

{% block title %}–ö–≤—ñ—Ç–∏ —Ç–∞ –ë—É–∫–µ—Ç–∏ | Flower Tale{% endblock %}

{% block content %}

<section class="filter-section">
  <h2 class="title-section">–ö–≤—ñ—Ç–∏ —Ç–∞ –ë—É–∫–µ—Ç–∏</h2>

   <form id="filters" method="get" action="{{ url_for('category.category') }}">
    <div class="filters-wrapper">
      {% macro render_filter(title, items, name, selected_values=[]) %}
      <div class="filter-dropdown">
        <button type="button" class="filter-toggle">{{ title }}</button>
        <div class="filter-options">
          {% for item in items %}
          <label>
            <input type="checkbox" name="{{ name }}" value="{{ item[name + '_id'] }}" {% if item[name + '_id'] in selected_values %}checked{% endif %}>
            {{ item[name + '_name'] }}
          </label>
          {% endfor %}
          <button type="button" class="reset-single-filter" data-filter-name="{{ name }}">–°–∫–∏–Ω—É—Ç–∏ {{ title|lower }}</button>
        </div>
      </div>
      {% endmacro %}

      {{ render_filter('–ü—Ä–∏–≤—ñ–¥', occasions, 'occasion', selected_occ) }}
      {{ render_filter('–†–æ–∑–º—ñ—Ä', sizes, 'size', selected_size) }}
      {{ render_filter('–ö–æ–ª—ñ—Ä', colors, 'color', selected_color) }}
      {{ render_filter('–î–ª—è –∫–æ–≥–æ', whoms, 'whom', selected_whom) }}

      <div class="filter-dropdown">
        <button type="button" class="filter-toggle">–¶—ñ–Ω–∞</button>
        <div class="filter-options">
          <label>
            <input type="radio" name="price" value="asc" {% if selected_price_sort == 'asc' %}checked{% endif %}>
            –°–ø–æ—á–∞—Ç–∫—É –¥–µ—à–µ–≤—à—ñ
          </label>
          <label>
            <input type="radio" name="price" value="desc" {% if selected_price_sort == 'desc' %}checked{% endif %}>
            –°–ø–æ—á–∞—Ç–∫—É –¥–æ—Ä–æ–∂—á—ñ
          </label>
          <button type="button" class="reset-single-filter" data-filter-name="price">–°–∫–∏–Ω—É—Ç–∏ —Ü—ñ–Ω—É</button>
        </div>
      </div>
    </div>

    <div class="filter-tabs-wrapper">
      <button class="arrow left" id="scrollLeftBtn" type="button">‚Üê</button>
      <div class="filter-tabs-container">
        <div class="filter-tabs-slider" id="tabSlider">
          {% for item in types %}
          <button type="submit" name="type" value="{{ item.type_b_id }}" class="tab-btn {% if item.type_b_id in selected_type %}active{% endif %}" data-tab-id="{{ item.type_b_id }}">
            {{ item.type_b_name.strip() }}
          </button>
          {% endfor %}
        </div>
      </div>
      <button class="arrow right" id="scrollRightBtn" type="button">‚Üí</button>
    </div>
  </form>
  <div class="decor-layer">
    <div id="dynamic-decor-container"></div>
  </div>
  

  <div class="container">
     <!-- <div id="bouquet-list" class="bouquet-slider"> -->
      <div id="bouquet-list" class="bouquet-slider">
    {% for bouquet in bouquets %}
    <div class="bouquet-clean-card reveal">
        <div class="bouquet-img-wrapper">
            <a href="{{ url_for('product.product', bouquet_id=bouquet.bouquet_id) }}">
                <img src="{{ url_for('static', filename=bouquet.bouquet_image.lstrip('/')) }}" alt="{{ bouquet.bouquet_name }}">
            </a>
            <button class="fav-btn">‚ô°</button>
        </div>
        <h3>
            <a href="{{ url_for('product.product', bouquet_id=bouquet.bouquet_id) }}">
                {{ bouquet.bouquet_name }}
            </a>
        </h3>
        <p>{{ bouquet.bouquet_price }} –≥—Ä–Ω</p>
        <button class="btn-to-cart">
            üõí –í –∫–æ—à–∏–∫
        </button>
    </div>
    {% endfor %}
</div>
    
    
    {% if current_page < total_pages %}
    <div class="btn-holder">
      <button id="load-more" class="load-more" data-page="{{ current_page }}" data-total="{{ total_pages }}">
        –î–∏–≤–∏—Ç–∏—Å—è —â–µ <span class="icon icon-arrrow-down"></span>
      </button>
    </div>
    {% endif %}
  </div>

  <div class="pagination">
    {% if page_links.prev %}
    <a href="{{ page_links.prev }}" class="btn prev">‚Üê</a>
    {% endif %}
    <span>–°—Ç–æ—Ä—ñ–Ω–∫–∞ {{ current_page }} –∑ {{ total_pages }}</span>
    {% if page_links.next %}
    <a href="{{ page_links.next }}" class="btn next">‚Üí</a>
    {% endif %}
  </div>

</section>

<script>
const shownDecorHeights = new Set();
let nextDecorIndex = 0;
const spacingFactor = 1.1;

function addDecorIfNeeded() {
  const decorContainer = document.getElementById("dynamic-decor-container");
  const footer = document.querySelector("footer");
  if (!decorContainer || !footer) return;

  const viewportHeight = window.innerHeight;
  const imageHeight = 200;
  const footerTop = footer.getBoundingClientRect().top + window.scrollY;

  const topPosition = nextDecorIndex * viewportHeight * spacingFactor;

  // üö´ –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ: —á–∏ —Ç–æ—á–Ω–æ –Ω–µ –≤–∏–ª—ñ–∑–µ –Ω–∞ —Ñ—É—Ç–µ—Ä
  if (topPosition + imageHeight > footerTop - 50) return;

  // –î–æ–¥–∞—î–º–æ –Ω–æ–≤–∏–π –¥–µ–∫–æ—Ä
  if (scrollY + viewportHeight + 100 > topPosition) {
    const img = document.createElement("img");

    const animations = ["fadeInUp", "fadeInLeft", "fadeInRight"];
    const randomAnim = animations[Math.floor(Math.random() * animations.length)];

    img.classList.add("decor", "decor-animated");
    img.style.animationName = randomAnim;

    img.src = nextDecorIndex % 2 === 0 ? "/static/images/decor1.png" : "/static/images/decor2.png";
    img.alt = "decor";

    img.style.width = nextDecorIndex % 2 === 0 ? "40vw" : "35vw";
    img.style.maxWidth = "500px";
    img.style.left = nextDecorIndex % 2 === 0 ? "15%" : "auto";
    img.style.right = nextDecorIndex % 2 === 0 ? "auto" : "15%";
    img.style.top = `${topPosition}px`;

    decorContainer.appendChild(img);
    nextDecorIndex++;
  }
}


function addDecorOnScroll() {
  addDecorIfNeeded();
}




  document.addEventListener("DOMContentLoaded", function () {
    // === –ü—Ä–æ–∫—Ä—É—Ç–∫–∞ –≤–∫–ª–∞–¥–æ–∫ ===
    const slider = document.getElementById("tabSlider");
    const container = document.querySelector(".filter-tabs-container");
    const leftArrow = document.getElementById("scrollLeftBtn");
    const rightArrow = document.getElementById("scrollRightBtn");
    const itemWidth = 192;

    function animateShift(direction) {
      slider.style.transition = "transform 0.4s ease";
      slider.style.transform = `translateX(${direction === "left" ? -itemWidth : itemWidth}px)`;

      setTimeout(() => {
        slider.style.transition = "none";
        slider.style.transform = "translateX(0)";
        if (direction === "left") {
          const first = slider.firstElementChild;
          slider.appendChild(first);
        } else {
          const last = slider.lastElementChild;
          slider.insertBefore(last, slider.firstElementChild);
        }
      }, 400);
    }

    leftArrow.addEventListener("click", () => animateShift("left"));
    rightArrow.addEventListener("click", () => animateShift("right"));

    // === –ö–Ω–æ–ø–∫–∞ "–î–∏–≤–∏—Ç–∏—Å—è —â–µ" ===
    const loadMoreBtn = document.getElementById("load-more");
    const bouquetList = document.getElementById("bouquet-list");

    if (loadMoreBtn) {
      let currentPage = parseInt(loadMoreBtn.getAttribute("data-page"));
      const totalPages = parseInt(loadMoreBtn.getAttribute("data-total"));

      loadMoreBtn.addEventListener("click", function () {
        const params = new URLSearchParams(window.location.search);
        currentPage++;
        params.set("page", currentPage);
        params.set("ajax", "1");

        fetch(`/category/load_more?${params.toString()}`)
          .then(response => response.text())
          .then(html => {
            const tempDiv = document.createElement("div");
            tempDiv.innerHTML = html;
            const newItems = tempDiv.querySelectorAll(".bouquet-clean-card");

            newItems.forEach(item => bouquetList.appendChild(item));

            loadMoreBtn.setAttribute("data-page", currentPage);
            sessionStorage.setItem("loadedPages", currentPage);

            if (currentPage >= totalPages) {
              loadMoreBtn.style.display = "none";
            }

            setTimeout(() => {
              addDecorOnScroll();
            }, 300);


          });
      });
    }

 
    // === –ê–∫—Ç–∏–≤–Ω–∞ –≤–∫–ª–∞–¥–∫–∞ ===
    document.querySelectorAll(".tab-btn").forEach(btn => {
      btn.addEventListener("click", () => {
        const tabId = btn.getAttribute("data-tab-id");
        sessionStorage.setItem("activeTabId", tabId);
      });
    });

    const activeTabId = sessionStorage.getItem("activeTabId");
    if (activeTabId) {
      const activeBtn = slider.querySelector(`.tab-btn[data-tab-id="${activeTabId}"]`);
      if (activeBtn) {
        const containerRect = container.getBoundingClientRect();
        const btnRect = activeBtn.getBoundingClientRect();
        const offset = btnRect.left - containerRect.left;
        container.scrollLeft += offset - container.offsetWidth / 2 + btnRect.width / 2;
      }
    }

    // === –û–±—Ä–æ–±–∫–∞ —á–µ–∫–±–æ–∫—Å—ñ–≤ —ñ —Å–µ–ª–µ–∫—Ç—ñ–≤ ===
    document.querySelectorAll('input[type="checkbox"]').forEach(checkbox => {
      checkbox.addEventListener('change', () => {
        document.getElementById('filters').submit();
      });
    });

    document.querySelectorAll('select').forEach(select => {
      select.addEventListener('change', () => {
        document.getElementById('filters').submit();
      });
    });

    // === –†–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è —Ñ—ñ–ª—å—Ç—Ä—ñ–≤ ===
    document.querySelectorAll('.filter-toggle').forEach(toggle => {
      toggle.addEventListener('click', () => {
        const parent = toggle.closest('.filter-dropdown');
        parent.classList.toggle('open');
      });
    });

    document.addEventListener('click', function (e) {
      document.querySelectorAll('.filter-dropdown').forEach(dropdown => {
        if (!dropdown.contains(e.target)) {
          dropdown.classList.remove('open');
        }
      });
    });

    // === –°–∫–∏–¥–∞–Ω–Ω—è –æ–∫—Ä–µ–º–∏—Ö —Ñ—ñ–ª—å—Ç—Ä—ñ–≤ ===
    document.querySelectorAll('.reset-single-filter').forEach(button => {
      button.addEventListener('click', function () {
        const filterName = this.getAttribute("data-filter-name");
        document.querySelectorAll(`input[name="${filterName}"]`).forEach(input => {
          input.checked = false;
        });
        document.getElementById('filters').submit();
      });
    });

    // –ó–∞–ø—É—Å–∫ –ø–µ—Ä–≤–∏–Ω–Ω–æ–≥–æ –¥–µ–∫–æ—Ä—É
    addDecorOnScroll();
window.addEventListener("scroll", addDecorOnScroll);

  });

  function revealOnScroll() {
  const reveals = document.querySelectorAll('.reveal');
  const windowHeight = window.innerHeight;

  reveals.forEach(elem => {
    const elementTop = elem.getBoundingClientRect().top;
    const visiblePoint = 100;

    if (elementTop < windowHeight - visiblePoint) {
      elem.classList.add('visible');
    }
  });
}

document.addEventListener("DOMContentLoaded", () => {
  window.addEventListener("scroll", revealOnScroll);
  revealOnScroll(); // –æ–¥—Ä–∞–∑—É –ø—Ä–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ
});
document.querySelectorAll(".btn-to-cart").forEach(button => {
  button.addEventListener("click", function () {
    const card = this.closest(".bouquet-clean-card");
    const bouquetId = card.querySelector("a").href.split("/").pop(); // ID –∑ URL

    fetch("/cart/add", {
      method: "POST",
      headers: {
        "Content-Type": "application/json"
      },
      body: JSON.stringify({ bouquet_id: parseInt(bouquetId), is_custom: false })
    })
    .then(response => response.json())
    .then(data => {
      if (data.success) {
        alert("–î–æ–¥–∞–Ω–æ –¥–æ –∫–æ—à–∏–∫–∞ ‚úÖ");

        // –æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ: –æ–Ω–æ–≤–∏—Ç–∏ mini_cart
        fetch("/cart/mini")
          .then(res => res.text())
          .then(html => {
            const miniCart = document.getElementById("mini-cart");
            if (miniCart) miniCart.innerHTML = html;
          });
      } else {
        alert("–ü–æ–º–∏–ª–∫–∞ –¥–æ–¥–∞–≤–∞–Ω–Ω—è ‚ùå");
      }
    })
    .catch(err => {
      console.error("–ü–æ–º–∏–ª–∫–∞ –∑–∞–ø–∏—Ç—É:", err);
    });
  });
});

</script>


{% endblock %}

  
